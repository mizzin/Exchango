import{_ as x,a as p,c as _,o as L,b as S,w as $,A as w,e as B,p as k,f as o,g as t,i as s,j as D,F as v,l as y,t as r,z as I}from"./index-BT3itL6u.js";const z={class:"notice-list"},P={key:0},E=["onClick"],F=["onClick"],J={key:0,class:"pagination"},M=["onClick"],u=20,O={__name:"AdminNoticeList",setup(T){const l=B(),i=p([]),c=p(1),d=_(()=>{const e=(c.value-1)*u;return i.value.slice(e,e+u)}),m=_(()=>Math.ceil(i.value.length/u)),f=e=>{c.value=e},h=async()=>{const e=localStorage.getItem("admin_token");if(e&&JSON.parse(atob(e.split(".")[1])),!e){alert("로그인이 필요합니다."),l.push("/admin/login");return}try{if(JSON.parse(atob(e.split(".")[1])).exp*1e3<Date.now()){alert("세션이 만료되었습니다. 다시 로그인해주세요."),localStorage.removeItem("admin_token"),l.push("/admin/login");return}}catch(n){console.error("토큰 파싱 오류:",n),l.push("/admin/login");return}try{const n=await k.get("/admin/notices",{headers:{Authorization:`Bearer ${e}`}});i.value=n.data.notices}catch(n){console.error("❌ 공지 불러오기 실패:",n)}},C=e=>{l.push(`/admin/notices/${e}/edit`)},N=async e=>{if(!confirm("정말 삭제하시겠습니까?"))return;const n=localStorage.getItem("admin_token");try{await k.delete(`/admin/notices/${e}`,{headers:{Authorization:`Bearer ${n}`}}),h()}catch(a){console.error("❌ 삭제 실패:",a)}},b=()=>{l.push("/admin/notices/create")},A=e=>new Date(e).toLocaleString();return L(h),(e,n)=>(o(),S(w,null,{default:$(()=>[t("div",z,[t("div",{class:"notice-header"},[n[0]||(n[0]=t("h2",null,"Notice List",-1)),t("button",{class:"create-btn",onClick:b},"새 글 등록하기")]),t("table",null,[n[2]||(n[2]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Language"),t("th",null,"Title"),t("th",null,"Created At"),t("th",null,"Actions")])],-1)),t("tbody",null,[d.value.length===0?(o(),s("tr",P,n[1]||(n[1]=[t("td",{colspan:"5",style:{"text-align":"center",padding:"20px"}},"등록된 공지사항이 없습니다.",-1)]))):(o(!0),s(v,{key:1},y(d.value,a=>(o(),s("tr",{key:a.id},[t("td",null,r(a.id),1),t("td",null,r(a.language),1),t("td",null,r(a.title),1),t("td",null,r(A(a.created_at)),1),t("td",null,[t("button",{onClick:g=>C(a.id)},"Edit",8,E),t("button",{onClick:g=>N(a.id)},"Delete",8,F)])]))),128))])]),m.value>1?(o(),s("div",J,[(o(!0),s(v,null,y(m.value,a=>(o(),s("button",{key:a,onClick:g=>f(a),class:I({active:a===c.value})},r(a),11,M))),128))])):D("",!0)])]),_:1}))}},j=x(O,[["__scopeId","data-v-03a8a236"]]);export{j as default};
