import{_ as U,a as k,c as y,o as W,p as w,b as z,w as I,A as T,f as s,g as e,i as o,j as _,k as m,v as Y,m as C,s as F,z as d,F as S,l as $,t as r}from"./index-BUlgKWMI.js";import{d as L}from"./dayjs.min-Cbbdfn5l.js";const N={class:"admin-trade"},R={class:"filter-bar-row"},H={class:"filter-bar-row"},K={key:0},E={class:"currency-pill"},q={key:0},G={key:1},J={key:0,class:"action-buttons"},O=["onClick"],Q=["onClick"],X={key:1,style:{"text-align":"center",padding:"2rem",color:"#777"}},Z={key:2,class:"pagination"},tt=["disabled"],et=["onClick"],at=["disabled"],f=10,nt={__name:"AdminWithdraw",setup(lt){const D=k([]),n=k({username:"",status:"",currency:"",dateShortcut:"",startDate:"",endDate:""}),u=k(1),g=y(()=>{const l=(u.value-1)*f;return D.value.slice(l,l+f)}),p=y(()=>Math.ceil(D.value.length/f)),V=y(()=>{const t=[],a=Math.floor((u.value-1)/10)*10+1,c=Math.min(a+10-1,p.value);for(let v=a;v<=c;v++)t.push(v);return t}),h=l=>{l>=1&&l<=p.value&&(u.value=l,window.scrollTo({top:0,behavior:"smooth"}))};W(async()=>{await i()});const i=async()=>{const l=localStorage.getItem("admin_token");try{const t=await w.get("/admin/trade/withdraw",{headers:{Authorization:`Bearer ${l}`},params:{username:n.value.username,status:n.value.status,currency:n.value.currency,startDate:n.value.startDate,endDate:n.value.endDate}});D.value=t.data.transactions||[],u.value=1}catch(t){console.error("출금 내역 로딩 실패:",t)}},x=()=>{i()},P=()=>{n.value={username:"",status:"",currency:"",dateShortcut:"",startDate:"",endDate:""},i()},b=l=>{const t=L();switch(n.value.dateShortcut=l,l){case"today":n.value.startDate=t.format("YYYY-MM-DD"),n.value.endDate=t.format("YYYY-MM-DD");break;case"1w":n.value.startDate=t.subtract(7,"day").format("YYYY-MM-DD"),n.value.endDate=t.format("YYYY-MM-DD");break;case"1m":n.value.startDate=t.subtract(1,"month").format("YYYY-MM-DD"),n.value.endDate=t.format("YYYY-MM-DD");break;case"3m":n.value.startDate=t.subtract(3,"month").format("YYYY-MM-DD"),n.value.endDate=t.format("YYYY-MM-DD");break}},j=l=>{switch(l){case"pending":return"대기 중";case"completed":return"완료";case"rejected":return"거절됨";default:return l}},M=l=>new Date(l).toLocaleString(),A=async l=>{const t=localStorage.getItem("admin_token");try{await w.patch(`/admin/trade/withdraw/${l}/approve`,{},{headers:{Authorization:`Bearer ${t}`}}),await i(),alert("승인 완료")}catch(a){console.error("승인 실패:",a),alert("승인 처리 중 오류 발생")}},B=async l=>{const t=localStorage.getItem("admin_token");try{await w.patch(`/admin/trade/withdraw/${l}/reject`,{},{headers:{Authorization:`Bearer ${t}`}}),await i(),alert("거절 완료")}catch(a){console.error("거절 실패:",a),alert("거절 처리 중 오류 발생")}};return(l,t)=>(s(),z(T,null,{default:I(()=>[e("div",N,[t[16]||(t[16]=e("h2",null,"💸 출금 신청 내역",-1)),e("div",R,[m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>n.value.username=a),placeholder:"사용자명 검색"},null,512),[[Y,n.value.username]]),m(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>n.value.status=a)},t[11]||(t[11]=[e("option",{value:""},"전체 상태",-1),e("option",{value:"pending"},"대기 중",-1),e("option",{value:"completed"},"완료",-1),e("option",{value:"rejected"},"거절됨",-1)]),512),[[C,n.value.status]]),m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>n.value.currency=a)},t[12]||(t[12]=[e("option",{value:""},"전체 통화",-1),e("option",{value:"KRW"},"₩ KRW",-1),e("option",{value:"PHP"},"₱ PHP",-1),e("option",{value:"USDT"},"₮ USDT",-1)]),512),[[C,n.value.currency]])]),e("div",H,[t[13]||(t[13]=F(" 요청일 ")),e("button",{class:d(["date-btn",{active:n.value.dateShortcut==="today"}]),onClick:t[3]||(t[3]=a=>b("today"))},"오늘",2),e("button",{class:d(["date-btn",{active:n.value.dateShortcut==="1w"}]),onClick:t[4]||(t[4]=a=>b("1w"))},"1주일",2),e("button",{class:d(["date-btn",{active:n.value.dateShortcut==="1m"}]),onClick:t[5]||(t[5]=a=>b("1m"))},"1개월",2),e("button",{class:d(["date-btn",{active:n.value.dateShortcut==="3m"}]),onClick:t[6]||(t[6]=a=>b("3m"))},"3개월",2),m(e("input",{type:"date","onUpdate:modelValue":t[7]||(t[7]=a=>n.value.startDate=a)},null,512),[[Y,n.value.startDate]]),t[14]||(t[14]=e("span",null,"~",-1)),m(e("input",{type:"date","onUpdate:modelValue":t[8]||(t[8]=a=>n.value.endDate=a)},null,512),[[Y,n.value.endDate]]),e("button",{class:"btn-submit",onClick:x},"검색"),e("button",{class:"btn-reset",onClick:P},"초기화")]),g.value.length?(s(),o("table",K,[t[15]||(t[15]=e("thead",null,[e("tr",null,[e("th",null,"사용자"),e("th",null,"플랫폼"),e("th",null,"플랫폼 ID"),e("th",null,"$"),e("th",null,"통화"),e("th",null,"환산 금액"),e("th",null,"상태"),e("th",null,"요청일"),e("th",null,"승인일시"),e("th",null,"처리")])],-1)),e("tbody",null,[(s(!0),o(S,null,$(g.value,a=>{var c;return s(),o("tr",{key:a.id},[e("td",null,r(a.username),1),e("td",null,r(a.platform_id),1),e("td",null,r(a.platform_user_id),1),e("td",null,r(a.amount),1),e("td",null,[e("span",E,r(a.currency),1)]),e("td",null,r((c=a.krw_amount)==null?void 0:c.toLocaleString()),1),e("td",null,[e("span",{class:d(["badge",a.status])},r(j(a.status)),3)]),e("td",null,r(M(a.created_at)),1),a.status==="completed"?(s(),o("td",q,r(M(a.updated_at)),1)):(s(),o("td",G,"-")),e("td",null,[a.status==="pending"?(s(),o("div",J,[e("button",{class:"btn-approve",onClick:v=>A(a.id)},"승인",8,O),e("button",{class:"btn-reject",onClick:v=>B(a.id)},"거절",8,Q)])):_("",!0)])])}),128))])])):(s(),o("p",X,"출금 요청 내역이 없습니다.")),p.value>1?(s(),o("div",Z,[e("button",{onClick:t[9]||(t[9]=a=>h(u.value-1)),disabled:u.value===1},"이전",8,tt),(s(!0),o(S,null,$(V.value,a=>(s(),o("span",{key:a},[e("button",{class:d({active:u.value===a}),onClick:c=>h(a)},r(a),11,et)]))),128)),e("button",{onClick:t[10]||(t[10]=a=>h(u.value+1)),disabled:u.value===p.value},"다음",8,at)])):_("",!0)])]),_:1}))}},rt=U(nt,[["__scopeId","data-v-3d97c54b"]]);export{rt as default};
