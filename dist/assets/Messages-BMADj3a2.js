import{_ as w,a as d,c as m,o as B,b as S,w as j,U as z,p as h,f as l,g as s,i as n,j as v,t as a,F as p,l as k,z as y}from"./index-BT3itL6u.js";const F={class:"messages-page"},D={class:"title"},I={key:0,class:"message-table"},L=["onClick"],N={key:1,class:"empty-message"},P={key:2,class:"pagination"},U=["onClick"],V={key:3,class:"modal"},A={class:"modal-content"},i=10,E={__name:"Messages",setup(q){const r=d([]),o=d(null),u=d(1),b=async()=>{localStorage.getItem("user_token");try{const e=await h.get("users/messages");r.value=e.data.messages||[]}catch(e){console.error("❌ Failed to load messages:",e)}},g=m(()=>{const e=(u.value-1)*i,c=e+i;return r.value.slice(e,c)}),_=m(()=>Math.ceil(r.value.length/i)),$=async e=>{const c=localStorage.getItem("token");try{const t=await h.get(`http://localhost:3000/users/messages/${e.id}`,{headers:{Authorization:`Bearer ${c}`}});o.value=t.data.message,e.is_read=1}catch(t){console.error("❌ Failed to read message:",t)}},M=()=>{o.value=null},f=e=>new Date(e).toLocaleString();return B(b),(e,c)=>(l(),S(z,null,{default:j(()=>[s("div",F,[s("h2",D,"📩 "+a(e.$t("messages.title")),1),g.value.length?(l(),n("table",I,[s("thead",null,[s("tr",null,[s("th",null,a(e.$t("messages.subject")),1),s("th",null,a(e.$t("messages.date")),1),s("th",null,a(e.$t("messages.status")),1)])]),s("tbody",null,[(l(!0),n(p,null,k(g.value,t=>(l(),n("tr",{key:t.id,onClick:C=>$(t),class:"clickable"},[s("td",null,a(t.subject),1),s("td",null,a(f(t.created_at)),1),s("td",null,[s("span",{class:y(t.is_read?"read animated":"unread")},a(t.is_read?e.$t("messages.read"):e.$t("messages.unread")),3)])],8,L))),128))])])):(l(),n("p",N,a(e.$t("messages.noMessages")),1)),_.value>1?(l(),n("div",P,[(l(!0),n(p,null,k(_.value,t=>(l(),n("button",{key:t,onClick:C=>u.value=t,class:y(["page-btn",{active:u.value===t}])},a(t),11,U))),128))])):v("",!0),o.value?(l(),n("div",V,[s("div",A,[s("h3",null,a(o.value.subject),1),s("p",null,a(o.value.content),1),s("button",{class:"btn-primary",onClick:M},"Close")])])):v("",!0)])]),_:1}))}},H=w(E,[["__scopeId","data-v-c7b2be38"]]);export{H as default};
