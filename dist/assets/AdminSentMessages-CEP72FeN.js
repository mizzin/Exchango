import{_ as b,a as r,c as y,o as w,b as C,w as S,A as x,d as p,f as d,g as e,i as c,j as A,k as h,v as B,m as $,F as D,l as I,t as n}from"./index-BUlgKWMI.js";const V={class:"admin-messages"},j={class:"filter-bar"},F=["onClick"],L=["onClick"],U={key:0,class:"popup"},z={__name:"AdminSentMessages",setup(N){const v=r([]),s=r(null),i=r(""),o=r(""),m=async()=>{const a=localStorage.getItem("admin_token"),t=await p.get("http://localhost:3000/admin/messages/sent",{headers:{Authorization:`Bearer ${a}`}});v.value=t.data.messages},_=a=>new Date(a).toLocaleString(),f=y(()=>v.value.filter(a=>{const t=a.to_username.includes(i.value),l=o.value===""||o.value==="true"&&a.is_read===1||o.value==="false"&&a.is_read===0;return t&&l})),k=a=>{s.value=a};w(m);const g=async a=>{var l,u;if(!confirm("삭제하시겠습니까?"))return;const t=localStorage.getItem("admin_token");try{await p.delete(`http://localhost:3000/admin/messages/${a}`,{headers:{Authorization:`Bearer ${t}`}}),alert("삭제 완료!"),m()}catch(M){alert(((u=(l=M.response)==null?void 0:l.data)==null?void 0:u.message)||"삭제 실패")}};return(a,t)=>(d(),C(x,null,{default:S(()=>[e("div",V,[t[5]||(t[5]=e("h2",null,"📬 보낸 쪽지 목록",-1)),e("div",j,[h(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>i.value=l),placeholder:"수신자 ID 검색"},null,512),[[B,i.value]]),h(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>o.value=l)},t[3]||(t[3]=[e("option",{value:""},"전체",-1),e("option",{value:"false"},"읽지 않음",-1),e("option",{value:"true"},"읽음",-1)]),512),[[$,o.value]])]),e("table",null,[t[4]||(t[4]=e("thead",null,[e("tr",null,[e("th",null,"받는 사용자"),e("th",null,"제목"),e("th",null,"언어"),e("th",null,"보낸 날짜"),e("th",null,"내용 보기"),e("th",null,"읽음여부"),e("th",null,"삭제")])],-1)),e("tbody",null,[(d(!0),c(D,null,I(f.value,l=>(d(),c("tr",{key:l.id},[e("td",null,n(l.to_username),1),e("td",null,n(l.subject),1),e("td",null,n(l.language),1),e("td",null,n(_(l.created_at)),1),e("td",null,[e("button",{onClick:u=>k(l)},"보기",8,F)]),e("td",null,n(l.is_read?"읽음":"읽지 않음"),1),e("td",null,[e("button",{onClick:u=>g(l.id)},"삭제",8,L)])]))),128))])]),s.value?(d(),c("div",U,[e("h3",null,n(s.value.subject),1),e("p",null,n(s.value.content),1),e("button",{onClick:t[2]||(t[2]=l=>s.value=null)},"닫기")])):A("",!0)])]),_:1}))}},T=b(z,[["__scopeId","data-v-83d0536c"]]);export{T as default};
